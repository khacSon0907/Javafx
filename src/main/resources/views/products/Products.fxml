<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.coffeeshop.coffeeshop.controller.ProductController"
            style="-fx-background-color: linear-gradient(to bottom, #F5F5DC, #E8D5B7);">

    <!-- Enhanced Header with Modern Design -->
    <top>
        <VBox>
            <HBox alignment="CENTER" spacing="15"
                  style="-fx-background-color: linear-gradient(135deg, #8B4513 0%, #A0522D 50%, #CD853F 100%);
                         -fx-padding: 25;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.4), 10, 0, 0, 3);">
                <Label text="â˜•"
                       style="-fx-font-size: 36px;" />
                <Label text="QUáº¢N LÃ Sáº¢N PHáº¨M COFFEE SHOP"
                       style="-fx-font-size: 32px;
                              -fx-font-weight: bold;
                              -fx-text-fill: #FFF8DC;
                              -fx-font-family: 'Segoe UI', 'Arial', 'sans-serif';
                              -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.5), 3, 0, 1, 1);" />
                <Label text="ðŸ“¦"
                       style="-fx-font-size: 36px;" />
            </HBox>

            <!-- Quick Stats Bar -->
            <HBox alignment="CENTER" spacing="40"
                  style="-fx-background-color: rgba(139, 69, 19, 0.15);
                         -fx-padding: 15;">
                <Label fx:id="lblTotalProducts"
                       text="ðŸ“Š Tá»•ng: 0 sáº£n pháº©m"
                       style="-fx-font-size: 16px;
                              -fx-font-weight: bold;
                              -fx-text-fill: #8B4513;" />
                <Separator orientation="VERTICAL" prefHeight="20" />
                <Label fx:id="lblActiveProducts"
                       text="âœ… Äang bÃ¡n: 0"
                       style="-fx-font-size: 16px;
                              -fx-font-weight: bold;
                              -fx-text-fill: #228B22;" />
                <Separator orientation="VERTICAL" prefHeight="20" />
                <Label fx:id="lblInactiveProducts"
                       text="âŒ Ngá»«ng bÃ¡n: 0"
                       style="-fx-font-size: 16px;
                              -fx-font-weight: bold;
                              -fx-text-fill: #B22222;" />
            </HBox>
        </VBox>
    </top>

    <!-- Enhanced Main Content -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true"
                    style="-fx-background-color: transparent;
                           -fx-background: transparent;">
            <HBox spacing="25" style="-fx-padding: 30;">

                <!-- Enhanced Left Side - Product Table Section -->
                <VBox spacing="20" HBox.hgrow="ALWAYS" prefWidth="750"
                      style="-fx-background-color: white;
                             -fx-background-radius: 20;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 15, 0, 0, 5);
                             -fx-padding: 30;">

                    <!-- Enhanced Search Section -->
                    <VBox spacing="15">
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Label text="ðŸ“‹ DANH SÃCH Sáº¢N PHáº¨M"
                                   style="-fx-font-size: 22px;
                                          -fx-font-weight: bold;
                                          -fx-text-fill: #8B4513;" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button text="ðŸ”„ LÃ m má»›i"
                                    style="-fx-background-color: linear-gradient(to bottom, #87CEEB, #4682B4);
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 15;
                                           -fx-pref-width: 120;
                                           -fx-pref-height: 35;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);" />
                        </HBox>

                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <TextField fx:id="txtSearch"
                                       promptText="ðŸ” TÃ¬m kiáº¿m theo tÃªn, danh má»¥c..."
                                       prefWidth="300"
                                       style="-fx-background-radius: 25;
                                              -fx-border-color: #D2B48C;
                                              -fx-border-radius: 25;
                                              -fx-border-width: 2;
                                              -fx-padding: 12 20 12 20;
                                              -fx-font-size: 15px;
                                              -fx-background-color: #FAFAFA;
                                              -fx-effect: innershadow(gaussian, rgba(0,0,0,0.1), 3, 0, 0, 1);" />

                            <ComboBox fx:id="cbFilterCategory"
                                      promptText="Lá»c theo danh má»¥c"
                                      prefWidth="180"
                                      style="-fx-background-radius: 15;
                                             -fx-border-color: #D2B48C;
                                             -fx-border-radius: 15;
                                             -fx-font-size: 14px;" />

                            <ComboBox fx:id="cbFilterStatus"
                                      promptText="Lá»c theo tráº¡ng thÃ¡i"
                                      prefWidth="160"
                                      style="-fx-background-radius: 15;
                                             -fx-border-color: #D2B48C;
                                             -fx-border-radius: 15;
                                             -fx-font-size: 14px;" />
                        </HBox>
                    </VBox>

                    <!-- Enhanced Table -->
                    <TableView fx:id="tableProducts"
                               prefHeight="580"
                               style="-fx-background-color: #FAFAFA;
                                      -fx-background-radius: 15;
                                      -fx-border-color: #D2B48C;
                                      -fx-border-radius: 15;
                                      -fx-border-width: 2;
                                      -fx-effect: innershadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 2);">
                        <columns>
                            <TableColumn fx:id="colId" text="ID" prefWidth="50"
                                         style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="colImage" text="áº¢nh" prefWidth="80"
                                         style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="colName" text="TÃªn sáº£n pháº©m" prefWidth="200" />
                            <TableColumn fx:id="colPrice" text="GiÃ¡ (VNÄ)" prefWidth="120"
                                         style="-fx-alignment: CENTER-RIGHT;" />
                            <TableColumn fx:id="colCategory" text="Danh má»¥c" prefWidth="130"
                                         style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="colDescription" text="MÃ´ táº£" prefWidth="180" />
                            <TableColumn fx:id="colStatus" text="Tráº¡ng thÃ¡i" prefWidth="100"
                                         style="-fx-alignment: CENTER;" />
                        </columns>
                    </TableView>

                    <!-- Enhanced Table Controls -->
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <Label fx:id="lblProductCount"
                               text="Hiá»ƒn thá»‹: 0 / 0 sáº£n pháº©m"
                               style="-fx-font-weight: bold;
                                      -fx-text-fill: #8B4513;
                                      -fx-font-size: 15px;" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button text="âŒ XÃ³a Ä‘Ã£ chá»n"
                                style="-fx-background-color: linear-gradient(to bottom, #FF6B6B, #EE5A52);
                                       -fx-text-fill: white;
                                       -fx-font-weight: bold;
                                       -fx-background-radius: 12;
                                       -fx-pref-width: 140;
                                       -fx-pref-height: 35;
                                       -fx-cursor: hand;
                                       -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);" />
                    </HBox>
                </VBox>

                <!-- Enhanced Right Side - Product Form Section -->
                <VBox spacing="25" prefWidth="480"
                      style="-fx-background-color: white;
                             -fx-background-radius: 20;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 15, 0, 0, 5);
                             -fx-padding: 30;">

                    <Label text="ðŸ“ THÃ”NG TIN Sáº¢N PHáº¨M"
                           style="-fx-font-size: 22px;
                                  -fx-font-weight: bold;
                                  -fx-text-fill: #8B4513;" />

                    <!-- Enhanced Product Image Section -->
                    <VBox alignment="CENTER" spacing="15"
                          style="-fx-border-color: #D2B48C;
                                 -fx-border-radius: 15;
                                 -fx-border-width: 2;
                                 -fx-background-color: linear-gradient(to bottom, #FAFAFA, #F0F0F0);
                                 -fx-background-radius: 15;
                                 -fx-padding: 20;
                                 -fx-effect: innershadow(gaussian, rgba(0,0,0,0.05), 5, 0, 0, 2);">
                        <Label text="ðŸ–¼ï¸ áº¢NH Sáº¢N PHáº¨M"
                               style="-fx-font-weight: bold;
                                      -fx-text-fill: #8B4513;
                                      -fx-font-size: 16px;" />

                        <StackPane style="-fx-background-color: white;
                                          -fx-background-radius: 10;
                                          -fx-border-color: #E0E0E0;
                                          -fx-border-radius: 10;
                                          -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                            <ImageView fx:id="imgPreview"
                                       fitWidth="140" fitHeight="140"
                                       preserveRatio="true" />
                        </StackPane>

                        <HBox spacing="10" alignment="CENTER">
                            <Button fx:id="btnChooseImage"
                                    text="ðŸ“· Chá»n áº£nh"
                                    style="-fx-background-color: linear-gradient(to bottom, #DEB887, #D2B48C);
                                           -fx-text-fill: #8B4513;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 10;
                                           -fx-pref-width: 120;
                                           -fx-pref-height: 35;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 4, 0, 0, 2);" />

                            <Button fx:id="btnRemoveImage"
                                    text="ðŸ—‘ï¸ XÃ³a áº£nh"
                                    style="-fx-background-color: linear-gradient(to bottom, #FFB6C1, #FFA0B4);
                                           -fx-text-fill: #8B0000;
                                           -fx-font-weight: bold;
                                           -fx-background-radius: 10;
                                           -fx-pref-width: 120;
                                           -fx-pref-height: 35;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 4, 0, 0, 2);" />
                        </HBox>
                    </VBox>

                    <!-- Enhanced Form Fields -->
                    <VBox spacing="20">
                        <!-- Product ID (Hidden when adding new) -->
                        <VBox spacing="8" fx:id="vboxId" visible="false" managed="false">
                            <Label text="ðŸ†” ID sáº£n pháº©m:"
                                   style="-fx-font-weight: bold; -fx-text-fill: #8B4513; -fx-font-size: 15px;" />
                            <TextField fx:id="txtId"
                                       editable="false"
                                       style="-fx-background-color: #F5F5F5;
                                              -fx-background-radius: 10;
                                              -fx-border-color: #D2B48C;
                                              -fx-border-radius: 10;
                                              -fx-padding: 12;
                                              -fx-font-size: 15px;" />
                        </VBox>

                        <!-- Product Name -->
                        <VBox spacing="8">
                            <Label text="ðŸ“ TÃªn sáº£n pháº©m: *"
                                   style="-fx-font-weight: bold; -fx-text-fill: #8B4513; -fx-font-size: 15px;" />
                            <TextField fx:id="txtName"
                                       promptText="Nháº­p tÃªn sáº£n pháº©m (VD: CÃ  phÃª Ä‘en Ä‘Ã¡)..."
                                       style="-fx-background-radius: 10;
                                              -fx-border-color: #D2B48C;
                                              -fx-border-radius: 10;
                                              -fx-border-width: 2;
                                              -fx-padding: 12;
                                              -fx-font-size: 15px;
                                              -fx-background-color: white;" />
                        </VBox>

                        <!-- Price -->
                        <VBox spacing="8">
                            <Label text="ðŸ’° GiÃ¡ tiá»n: *"
                                   style="-fx-font-weight: bold; -fx-text-fill: #8B4513; -fx-font-size: 15px;" />
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <TextField fx:id="txtPrice"
                                           promptText="0"
                                           prefWidth="300"
                                           style="-fx-background-radius: 10;
                                                  -fx-border-color: #D2B48C;
                                                  -fx-border-radius: 10;
                                                  -fx-border-width: 2;
                                                  -fx-padding: 12;
                                                  -fx-font-size: 15px;
                                                  -fx-background-color: white;" />
                                <Label text="VNÄ"
                                       style="-fx-font-weight: bold; -fx-text-fill: #8B4513; -fx-font-size: 15px;" />
                            </HBox>
                        </VBox>

                        <!-- Category -->
                        <VBox spacing="8">
                            <Label text="ðŸ·ï¸ Danh má»¥c: *"
                                   style="-fx-font-weight: bold; -fx-text-fill: #8B4513; -fx-font-size: 15px;" />
                            <ComboBox fx:id="cbCategory"
                                      prefWidth="420"
                                      promptText="Chá»n danh má»¥c sáº£n pháº©m..."
                                      style="-fx-background-radius: 10;
                                             -fx-border-color: #D2B48C;
                                             -fx-border-radius: 10;
                                             -fx-border-width: 2;
                                             -fx-font-size: 15px;
                                             -fx-background-color: white;" />
                        </VBox>

                        <!-- Status -->
                        <VBox spacing="8">
                            <Label text="ðŸ“Š Tráº¡ng thÃ¡i:"
                                   style="-fx-font-weight: bold; -fx-text-fill: #8B4513; -fx-font-size: 15px;" />
                            <HBox spacing="15" alignment="CENTER_LEFT">
                                <RadioButton fx:id="rbActive"
                                             text="âœ… Äang bÃ¡n"
                                             selected="true"
                                             style="-fx-font-size: 14px; -fx-text-fill: #228B22; -fx-font-weight: bold;" />
                                <RadioButton fx:id="rbInactive"
                                             text="âŒ Ngá»«ng bÃ¡n"
                                             style="-fx-font-size: 14px; -fx-text-fill: #B22222; -fx-font-weight: bold;" />
                            </HBox>
                        </VBox>

                        <!-- Description -->
                        <VBox spacing="8">
                            <Label text="ðŸ“„ MÃ´ táº£:"
                                   style="-fx-font-weight: bold; -fx-text-fill: #8B4513; -fx-font-size: 15px;" />
                            <TextArea fx:id="txtDescription"
                                      prefRowCount="4"
                                      wrapText="true"
                                      promptText="Nháº­p mÃ´ táº£ chi tiáº¿t vá» sáº£n pháº©m..."
                                      style="-fx-background-radius: 10;
                                             -fx-border-color: #D2B48C;
                                             -fx-border-radius: 10;
                                             -fx-border-width: 2;
                                             -fx-font-size: 14px;
                                             -fx-background-color: white;" />
                        </VBox>
                    </VBox>

                    <!-- Enhanced Action Buttons -->
                    <VBox spacing="15">
                        <!-- Primary Actions -->
                        <HBox spacing="12" alignment="CENTER">
                            <Button fx:id="btnAdd"
                                    text="âž• THÃŠM Má»šI"
                                    onAction="#handleAddProduct"
                                    style="-fx-pref-width: 130;
                                           -fx-pref-height: 45;
                                           -fx-background-color: linear-gradient(to bottom, #28a745, #218838);
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-font-size: 14px;
                                           -fx-background-radius: 15;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0, 0, 3);" />

                            <Button fx:id="btnEdit"
                                    text="âœï¸ Cáº¬P NHáº¬T"
                                    onAction="#handleEditProduct"
                                    style="-fx-pref-width: 130;
                                           -fx-pref-height: 45;
                                           -fx-background-color: linear-gradient(to bottom, #ffc107, #e0a800);
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-font-size: 14px;
                                           -fx-background-radius: 15;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0, 0, 3);" />

                            <Button fx:id="btnDelete"
                                    text="ðŸ—‘ï¸ XÃ“A"
                                    onAction="#handleDeleteProduct"
                                    style="-fx-pref-width: 130;
                                           -fx-pref-height: 45;
                                           -fx-background-color: linear-gradient(to bottom, #dc3545, #c82333);
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-font-size: 14px;
                                           -fx-background-radius: 15;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 8, 0, 0, 3);" />
                        </HBox>

                        <!-- Secondary Actions -->
                        <HBox spacing="12" alignment="CENTER">
                            <Button fx:id="btnClear"
                                    text="ðŸ§¹ XÃ“A FORM"
                                    style="-fx-pref-width: 190;
                                           -fx-pref-height: 40;
                                           -fx-background-color: linear-gradient(to bottom, #17a2b8, #138496);
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-font-size: 14px;
                                           -fx-background-radius: 12;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 6, 0, 0, 2);" />

                            <Button fx:id="btnBack"
                                    text="ðŸ”™ QUAY Láº I"
                                    style="-fx-pref-width: 190;
                                           -fx-pref-height: 40;
                                           -fx-background-color: linear-gradient(to bottom, #6c757d, #5a6268);
                                           -fx-text-fill: white;
                                           -fx-font-weight: bold;
                                           -fx-font-size: 14px;
                                           -fx-background-radius: 12;
                                           -fx-cursor: hand;
                                           -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 6, 0, 0, 2);" />
                        </HBox>
                    </VBox>
                </VBox>
            </HBox>
        </ScrollPane>
    </center>

    <!-- Enhanced Bottom Status Bar -->
    <bottom>
        <VBox>
            <!-- Progress Bar (Hidden by default) -->
            <ProgressBar fx:id="progressBar"
                         visible="false" managed="false"
                         prefWidth="Infinity" prefHeight="6"
                         style="-fx-accent: #8B4513;" />

            <!-- Status Bar -->
            <HBox alignment="CENTER_LEFT" spacing="20"
                  style="-fx-background-color: linear-gradient(to right, rgba(139, 69, 19, 0.1), rgba(160, 82, 45, 0.1));
                         -fx-background-radius: 15;
                         -fx-padding: 18;
                         -fx-margin: 15;">
                <Label text="â˜•"
                       style="-fx-font-size: 20px;" />
                <Label fx:id="lblStatus"
                       text="Sáºµn sÃ ng thao tÃ¡c"
                       style="-fx-font-weight: bold;
                              -fx-text-fill: #8B4513;
                              -fx-font-size: 15px;" />
                <Region HBox.hgrow="ALWAYS" />
                <Label fx:id="lblCurrentTime"
                       text="..."
                       style="-fx-text-fill: #8B4513;
                              -fx-font-size: 13px;" />
                <Separator orientation="VERTICAL" prefHeight="20" />
                <Label text="Coffee Shop Management System v2.0"
                       style="-fx-text-fill: #8B4513;
                              -fx-font-size: 13px;
                              -fx-font-style: italic;" />
            </HBox>
        </VBox>
    </bottom>
</BorderPane>